--[[
    MHBL-HUB | OFFICIAL SOURCE CODE (UPDATED)
    Giao diện: Rayfield
    Tính năng: Auto Farm Level, Auto Quest, Bring Mob
]]

-- 1. HỆ THỐNG KIỂM TRA KEY
if getgenv().Key ~= "MHBL-HUB" then
    game.Players.LocalPlayer:Kick("SAI KEY! Vui lòng dùng Key: MHBL-HUB")
    return
end

-- 2. KHỞI TẠO UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
   Name = "MHBL-HUB | BANANA EDITION",
   LoadingTitle = "Đang tải logic Farm...",
   ImageToggle = {
      Enabled = true,
      Image = "rbxassetid://14374867455", -- Nút Lá cờ VN
      Width = 60, Height = 60
   }
})

-- 3. BIẾN ĐIỀU KHIỂN
_G.AutoFarm = false
_G.SelectWeapon = "Melee"

-- 4. HÀM HỖ TRỢ (TWEEN & ATTACK)
local function Tween(Target)
    pcall(function()
        local Distance = (Target.p - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
        game:GetService("TweenService"):Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(Distance/300, Enum.EasingStyle.Linear), {CFrame = Target}):Play()
    end)
end

local function Click()
    game:GetService("VirtualUser"):CaptureController()
    game:GetService("VirtualUser"):Button1Down(Vector2.new(1280, 672))
end

-- 5. LOGIC AUTO FARM THEO LEVEL (Mẫu Sea 1)
function GetTarget()
    local LV = game.Players.LocalPlayer.Data.Level.Value
    if LV < 10 then
        return "Bandit", "BanditQuest1", 1, CFrame.new(1059, 15, 1550) -- Tên quái, Tên Q, ID Q, CFrame NPC
    elseif LV < 15 then
        return "Monkey", "JungleQuest", 1, CFrame.new(-1598, 35, 153)
    -- Bạn có thể thêm các đảo khác ở đây
    else
        return "Monkey", "JungleQuest", 1, CFrame.new(-1598, 35, 153)
    end
end

-- 6. GIAO DIỆN TAB
local MainTab = Window:CreateTab("Auto Farm", 4483345998)

MainTab:CreateToggle({
   Name = "Auto Farm Level",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoFarm = Value
      spawn(function()
          while _G.AutoFarm do
              task.wait()
              pcall(function()
                  local MobName, QuestName, QuestID, NPCCFrame = GetTarget()
                  
                  -- Kiểm tra túi đồ đã cầm vũ khí chưa
                  for _, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                      if v.ToolTip == _G.SelectWeapon then
                          game.Players.LocalPlayer.Character.Humanoid:EquipTool(v)
                      end
                  end

                  -- Logic Nhận Nhiệm Vụ
                  if not game:GetService("Players").LocalPlayer.PlayerGui.Main:FindFirstChild("Quest") then
                      Tween(NPCCFrame)
                      if (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - NPCCFrame.p).Magnitude < 5 then
                          game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("StartQuest", QuestName, QuestID)
                      end
                  else
                      -- Logic Đánh Quái
                      for _, v in pairs(game.Workspace.Enemies:GetChildren()) do
                          if v.Name == MobName and v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
                              repeat
                                  task.wait()
                                  v.HumanoidRootPart.CanCollide = false
                                  v.HumanoidRootPart.Size = Vector3.new(60, 60, 60) -- Phóng to quái để dễ đánh
                                  Tween(v.HumanoidRootPart.CFrame * CFrame.new(0, 10, 0))
                                  Click()
                              until not _G.AutoFarm or v.Humanoid.Health <= 0 or not game:GetService("Players").LocalPlayer.PlayerGui.Main:FindFirstChild("Quest")
                          end
                      end
                  end
              end)
          end
      end)
   end,
})

Rayfield:Notify({Title = "MHBL-HUB", Content = "Đã sẵn sàng farm!", Duration = 5})
