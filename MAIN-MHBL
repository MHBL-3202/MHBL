--[[
    MHBL-HUB | PRO EDITION (SEA 3 + TELEPORT)
    Giao diện: Rayfield
    Tính năng: Auto Farm Sea 3, Fast Attack, Auto Stats, Teleport, Anti-AFK
]]

-- 0. ANTI-AFK (Treo máy không bị văng)
game:GetService("Players").LocalPlayer.Idled:Connect(function()
    game:GetService("VirtualUser"):Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
    task.wait(1)
    game:GetService("VirtualUser"):Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
end)

-- 1. HỆ THỐNG KIỂM TRA KEY
if getgenv().Key ~= "MHBL-HUB" then
    game.Players.LocalPlayer:Kick("SAI KEY! Vui lòng dùng Key: MHBL-HUB")
    return
end

-- 2. KHỞI TẠO UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
   Name = "MHBL-HUB | PRO EDITION",
   LoadingTitle = "Đang nạp hệ thống Sea 3...",
   ImageToggle = { Enabled = true, Image = "rbxassetid://14374867455", Width = 60, Height = 60 }
})

-- 3. BIẾN ĐIỀU KHIỂN
_G.AutoFarm = false
_G.AutoStats = false
_G.SelectWeapon = "Melee"
_G.StatPoint = "Melee"

-- 4. HÀM HỖ TRỢ (TWEEN & LOGIC)
local function Tween(Target)
    pcall(function()
        local Distance = (Target.p - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
        game:GetService("TweenService"):Create(game.Players.LocalPlayer.Character.HumanoidRootPart, TweenInfo.new(Distance/350, Enum.EasingStyle.Linear), {CFrame = Target}):Play()
    end)
end

-- Fast Attack Logic
local function Attack()
    game:GetService("VirtualUser"):CaptureController()
    game:GetService("VirtualUser"):Button1Down(Vector2.new(1280, 672))
end

-- 5. DỮ LIỆU NHIỆM VỤ SEA 3
function GetQuest()
    local LV = game.Players.LocalPlayer.Data.Level.Value
    if LV >= 1500 and LV < 1525 then return "Pirate Millionaire", "PortTownQuest", 1, CFrame.new(-290, 7, 5329)
    elseif LV >= 1525 and LV < 1575 then return "Pistol Billionaire", "PortTownQuest", 2, CFrame.new(-290, 7, 5329)
    elseif LV >= 1775 and LV < 1800 then return "Fishman Raider", "TurtleQuest1", 1, CFrame.new(-13274, 532, -8038)
    elseif LV >= 2100 and LV < 2125 then return "Ice Cream Chef", "IceCreamIslandQuest", 1, CFrame.new(-906, 66, -12105)
    elseif LV >= 2300 and LV < 2325 then return "Cookie Crafter", "CakeQuest1", 1, CFrame.new(-2020, 38, -12124)
    else return "Pirate Millionaire", "PortTownQuest", 1, CFrame.new(-290, 7, 5329) end
end

-- 6. GIAO DIỆN TAB
local MainTab = Window:CreateTab("Auto Farm", 4483345998)
local StatsTab = Window:CreateTab("Auto Stats", 4483345998)
local TPTab = Window:CreateTab("Teleport", 4483345998)

-- Tab Auto Farm
MainTab:CreateToggle({
   Name = "Auto Farm Level (Sea 3)",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoFarm = Value
      spawn(function()
          while _G.AutoFarm do
              task.wait()
              pcall(function()
                  local Mob, QName, QID, NPC = GetQuest()
                  if not game:GetService("Players").LocalPlayer.PlayerGui.Main:FindFirstChild("Quest") then
                      Tween(NPC)
                      if (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - NPC.p).Magnitude < 5 then
                          game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("StartQuest", QName, QID)
                      end
                  else
                      for _, v in pairs(game.Workspace.Enemies:GetChildren()) do
                          if v.Name == Mob and v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
                              Tween(v.HumanoidRootPart.CFrame * CFrame.new(0, 10, 0))
                              Attack()
                          end
                      end
                  end
              end)
          end
      end)
   end,
})

-- Tab Auto Stats
StatsTab:CreateDropdown({
   Name = "Chọn chỉ số nâng",
   Options = {"Melee","Defense","Sword","Demon Fruit"},
   CurrentOption = {"Melee"},
   Callback = function(Option) _G.StatPoint = Option[1] end,
})

StatsTab:CreateToggle({
   Name = "Auto Stats",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoStats = Value
      spawn(function()
          while _G.AutoStats do
              task.wait(1)
              game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("AddPoint", _G.StatPoint, 1)
          end
      end)
   end,
})

-- Tab Teleport (Sea 3)
TPTab:CreateButton({
   Name = "Bay tới Mansion (Dinh Thự)",
   Callback = function() Tween(CFrame.new(-12463, 374, -7523)) end,
})

TPTab:CreateButton({
   Name = "Bay tới Đảo Bánh (Cake Land)",
   Callback = function() Tween(CFrame.new(-2020, 38, -12124)) end,
})

TPTab:CreateButton({
   Name = "Bay tới Port Town (Cảng)",
   Callback = function() Tween(CFrame.new(-290, 7, 5329)) end,
})

Rayfield:Notify({Title = "MHBL-HUB PRO", Content = "Đã tích hợp Sea 3 & Teleport!", Duration = 5})
